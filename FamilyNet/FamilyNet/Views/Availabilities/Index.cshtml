@model FamilyNet.Models.ViewModels.ScheduleViewModel

@{
    ViewData["Title"] = "Index";
}

<table class="table table-sm table-striped table-bordered">
    <tr>
        <th>&nbsp;</th>
        @foreach (var day in Model.Days)
        {
            <th>@day</th>
        }
    </tr>
    @{
        var style = string.Empty;
        @foreach (var kv in Model.Sorted)
        {
            <tr>
                <td>@kv.Key</td>

                @foreach (var day in Model.Days)
                {
                    var note = kv.Value.FirstOrDefault(a => a.DayOfWeek == day);
                    @if (note != null)
                    {
                        <td class="table-success">
                            <div class="btn-group btn-group" group">
                                <button id="btnGroupDrop1" type="button" class="btn btn-outline-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Редактировать
                                </button>
                                <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                                    <a asp-route-id="@note.ID" asp-action="Edit" class="dropdown-item">Другое время</a>
                                    <form asp-action="Delete" method="post"
                                          asp-route-id="@note.ID">
                                        @*<a asp-route-id="@note.ID" asp-action="Delete" method="Post" class="dropdown-item">Отменить</a>*@
                                        <input type="hidden" name="ID" value="@note.ID" />
                                        <button type="submit" class="dropdown-item">
                                           Отменить
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </td>
                    }
                    else { 
                    <td></td>
                    }
                    @*@foreach (var a in kv.Value)
                    {

                        @if (a.DayOfWeek == day)
                        {
                            style = "table-success";

                        }
                    }
                    style = string.Empty;*@
                }
            </tr>
        }
    }
    @*var flag = true;

        //foreach (var day in Model.Days)
        //{}

        foreach (var date in Model.Date)
        {
            <tr>
                <td>@date.TimeOfDay.Hours</td>

                @foreach (var item in Model.AvailabilityDTOList)
                {
                    if (item.FromHour.TimeOfDay == date.TimeOfDay && item.FromHour.DayOfWeek == date.DayOfWeek)
                    {
                        <td class="table-success"></td>
                    }
                    else
                    {
                        <td>&nbsp;</td>
                    }
                }
            </tr>
            flag = false;
        }*@
</table>

@*<th>Date</th>
    <th>Day of week</th>
    <th class="text-left">Free from hour</th>
    <th class="text-center">During</th>*@
@*<th class="text-center">Action</th>*@
@*@foreach (var item in Model)
    {
        <tr>
            <td class="text-right">@item.ID</td>
            <td class="text-left">@item.romHour.Date.ToString("dd-MM-yyyy")</td>
                <td class="text-left">@item.DayOfWeek</td>
                <td class="text-left">@item.FromHour.TimeOfDay</td>
                <td class="text-center">@item.VolunteerHours</td>
                <td class="text-center">
                    <form asp-action="Delete" method="post"
                          asp-route-id="@item.ID">
                        <a asp-action="Edit" class="btn btn-sm btn-warning"
                           asp-route-id="@item.ID">
                            Редактировать
                        </a>
                        <input type="hidden" name="ID" value="@item.ID" />
                        <button type="submit" class="btn btn-danger btn-sm">
                            Удалить
                        </button>
                    </form>
                </td>
        </tr>
    }*@
<div class="text-center">
    <a asp-action="Create" class="btn btn-primary">Добавить запись</a>
</div>